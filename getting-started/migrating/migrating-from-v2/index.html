<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.70.0" />
  <title>Migrating End Devices from V2 | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/" />
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.25b30cdd256bfe2021b3a162f05871509954bca5cc3a6e85d1f515ea9ed6aa0f.css" integrity="sha256-JbMM3SVr/iAhs6Fi8FhxUJlUvKXMOm6F0fUV6p7Wqg8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta itemprop="name" content="Migrating End Devices from V2">
  <meta itemprop="description" content="">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="Migrating End Devices from V2">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/">
  <meta name="twitter:title" content="Migrating End Devices from V2" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:card" content="summary" />
</head>


<body><nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div class="container is-fluid">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
        <p class="navbar-item is-size-7">v3.13</p>
      </a><div class="navbar-item navbar-search-brand">
        <div class="field has-addons has-addons-centered">
          <div class="control">
            <input id="search-input-brand" class="input search-bar" type="text" placeholder="Search the docs..." type="text">
          </div>
        </div>
      </div>
      
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a><div class="navbar-item navbar-search-menu">
            <div class="field has-addons has-addons-centered">
              <div class="control">
                <input id="search-input-menu" class="input search-bar" type="text" placeholder="Search the docs..." type="text">
              </div>
            </div>
          </div></div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="/docs/download/">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
  <script type="text/javascript">
    docsearch({
      apiKey: "",
      indexName: "thethingsstack",
      inputSelector: '#search-input-brand',
      debug: false 
    });
    docsearch({
      apiKey: "",
      indexName: "thethingsstack",
      inputSelector: '#search-input-menu',
      debug: false 
    });
  </script><div class="container" role="document">
  <div class="columns my-0 ">
      
      <div class="column is-3 is-2-desktop sidebar-left">
        

<nav class="side-navigation" aria-label="Main navigation">

<h2 class="title is-size-5">Getting Started</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/getting-started/" class="">Overview</a>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/quick-start/" class="">Quick Start</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/what-is-tts/" class="">What Is The Things Stack?</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/installation/" class="">Installing The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/console/" class="">Console</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/cli/" class="">Command-line Interface</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/upgrading/" class="">Upgrading The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/" class="">Migrating to The Things Stack</a>
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/major-changes/" class="">Major Changes In The Things Stack</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/" class="is-active">Migrating End Devices from V2</a>
    
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/packet-broker-requirements/" class="">Packet Broker Requirements for End Device Migration</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/migrate-using-console/" class="">Migrate using the Console</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/migrate-using-migration-tool/" class="">Migrate using the Migration Tool</a>
    
  </li>

</ul>


    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrate-from-chirpstack/" class="">Migrating End Devices from ChirpStack</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/import-devices/" class="">Import End Devices in The Things Stack</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migration-tool/" class="">Migration Tool</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/configure-mac-settings/" class="">Fine-tuning MAC Settings for End Devices</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/gateway-migration/" class="">Migrating Gateways</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/device-json/" class="">JSON File Reference</a>
    
  </li>

</ul>


    
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/ttn/" class="">The Things Network</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/cloud-hosted/" class="">The Things Stack Cloud</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/aws/" class="">The Things Stack AWS Launcher</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/user-management/" class="">Users and Organizations</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/api/" class="">Using the API</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/events/" class="">Working with Events</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/troubleshooting/" class="">Troubleshooting Getting Started</a>
  </li>
</ul>



</nav>








      </div>
      
      <div class="column is-9 is-8-desktop sidebar-middle">
        <div class="docs-content">
        <h1 class="title is-size-2">Migrating End Devices from V2
          
        </h1>
        
        <div class="content">
          <p>This section documents the process of migrating end devices from V2 to The Things Stack.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  <p>As previously announced, on <strong>July 1, 2021</strong> users will no longer be able to add new applications, devices and gateways on V2 deployments, i.e. V2 is going to <strong>read-only</strong> mode.</p>
<p>Make sure to migrate your gateways and devices from V2 to The Things Stack as soon as possible, since V2 machines are planned to be completely shut down on <strong>December 31, 2021</strong>.</p>

</div>

<div class="notification is-warning is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Warning:</h5>
  We highly recommend to always test the migration on a single end device or a small batch of end devices in order to make sure the migration process goes as expected.
</div>

<h2 id="prerequisites">Prerequisites</h2>
<ol>
<li>User account on The Things Network V2 or The Things Industries V2.</li>
<li>End device(s) and gateway(s) connected to a V2 network.</li>
<li>User account in The Things Stack.</li>
</ol>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  We <strong>highly recommend</strong> using The Things Stack version <code>3.12.0</code> or higher. Some of the features (like session migration) from this guide might not be available for prior versions.
</div>

<div class="notification is-primary is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Info:</h5>
  Starting from The Things Stack <code>v3.13.0</code> release, The Things Network community members can freely migrate their gateways from The Things Network V2 to The Things Stack Community Edition, while still providing uplink and downlink coverage to The Things Network V2. This means that the order of actions of migrating gateways and devices is no longer relevant - you can migrate your devices first and then your gateways, or vice versa.
</div>

<h2 id="add-application-in-the-things-stack">Add Application in The Things Stack</h2>
<p>Since end devices are being created within applications, you first need to add a new application in The Things Stack.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  When adding an application in The Things Stack, the <strong>Application ID</strong> does not have to be the same as the one in V2.
</div>

<blockquote>
<p>See <a href="https://www.thethingsindustries.com/docs/integrations/adding-applications/">Adding Applications</a> for detailed instructions.</p>
</blockquote>
<h2 id="add-payload-formatters-and-integrations-in-the-things-stack">Add Payload Formatters and Integrations in The Things Stack</h2>
<p>After creating an application, you need to add the associated elements like application-level payload formatters and integrations.</p>
<div class="notification is-primary is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Info:</h5>
  The payload formatters can be uplink and downlink, and they are what was known in V2 as encoders and decoders. In The Things Stack, it is also possible to add payload formatters per end device, which override application payload formatters. However, before devices are migrated to The Things Stack it is only possible to add a payload formatter per application.
</div>

<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  <p>The format of V2 payload encoders and decoders is still supported in The Things Stack. You only need to add one additional line to the function code used in V2 to make it fully compatible with The Things Stack. For example, if your payload decoder function in V2 was:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">Decoder</span><span class="p">(</span><span class="nx">bytes</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">temperature</span> <span class="o">=</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">|</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>  
    <span class="k">return</span> <span class="p">{</span>
        <span class="nx">temperature</span><span class="o">:</span> <span class="nx">temperature</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>then your uplink payload formatter function in The Things Stack should be:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">decodeUplink</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">bytes</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">bytes</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">temperature</span> <span class="o">=</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">|</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="nx">temperature</span><span class="o">:</span> <span class="nx">temperature</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<blockquote>
<p>See <a href="https://www.thethingsindustries.com/docs/integrations/payload-formatters/">Payload Formatters</a> guide for detailed instructions on how to add payload formatters and which types are supported by The Things Stack.</p>
</blockquote>
<blockquote>
<p>For detailed tutorials on the integrations that are available in The Things Stack, see <a href="https://www.thethingsindustries.com/docs/integrations/payload-formatters/">Integrations</a>.</p>
</blockquote>
<h2 id="migrate-end-devices">Migrate End Devices</h2>
<p>When you have added your application and elements associated with it, it is time to migrate your end device(s) from V2 to The Things Stack.</p>
<div class="notification is-primary is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Info:</h5>
  <p>End devices connected to The Things Network V2 can be migrated to The Things Stack Cloud and The Things Stack Community Edition without the need for migrating a gateway, thanks to the default connection with <a href="https://www.thethingsindustries.com/docs/reference/packet-broker/">Packet Broker</a>. The Things Industries V2 (SaaS) can also be connected to Packet Broker by contacting <a href="mailto:support@thethingsindustries.com">support</a>, while The Things Stack Enterprise or Open Source can be <a href="https://www.thethingsindustries.com/docs/reference/packet-broker/connect/">configured</a> manually.</p>
<p>If you are using deployments connected to Packet Broker, the traffic from your end device(s) will be routed to The Things Stack after migrating your device(s). However, there are certain requirements that your devices need to meet for Packet Broker to route their traffic to The Things Stack correctly. See <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/packet-broker-requirements/">Packet Broker Requirements for End Device Migration</a> for detailed information.</p>
<p>If you are using deployments that are not connected to Packet Broker, you will have to <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/gateway-migration/">migrate your gateway</a> to receive traffic from your end device in The Things Stack.</p>

</div>

<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  Starting from The Things Stack <code>v3.13.0</code> release, The Things Network community members can freely migrate their gateways from The Things Network V2 to The Things Stack Community Edition, while still providing uplink and downlink coverage to The Things Network V2.
</div>

<p>There are two approaches for migrating devices, depending on how many end devices you intend to migrate and if you wish to migrate with or without active sessions, described in the following guides:</p>
<ul>
<li><a href="/docs/getting-started/migrating/migrating-from-v2/migrate-using-console/">Using The Things Stack Console</a></li>
<li><a href="/docs/getting-started/migrating/migrating-from-v2/migrate-using-migration-tool/">Using <code>ttn-lw-migrate</code> tool</a></li>
</ul>
        </div>
        
          <div class="columns is-multiline">
  <div class="column is-half is-flex">
    <div class="card has-radius is-fullwidth">
      <div class="card-content">
        <h1 class="title is-size-5 is-uppercase"><a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/packet-broker-requirements/">Packet Broker Requirements for End Device Migration</a>
        </h1>
        
        <div class="content has-text-grey">
          Read this section if you want to make use of Packet Broker to migrate your end devices and route traffic from V2 to The Things Stack.

        </div>
        <div class="buttons">
          <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/packet-broker-requirements/" class="button is-primary is-outlined">Read</a>
        </div>
      </div>
    </div>
  </div>
  <div class="column is-half is-flex">
    <div class="card has-radius is-fullwidth">
      <div class="card-content">
        <h1 class="title is-size-5 is-uppercase"><a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/migrate-using-console/">Migrate using the Console</a>
        </h1>
        
        <div class="content has-text-grey">
          This section refers to migrating end devices to The Things Stack by using The Things Stack Console.

        </div>
        <div class="buttons">
          <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/migrate-using-console/" class="button is-primary is-outlined">Read</a>
        </div>
      </div>
    </div>
  </div>
  <div class="column is-half is-flex">
    <div class="card has-radius is-fullwidth">
      <div class="card-content">
        <h1 class="title is-size-5 is-uppercase"><a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/migrate-using-migration-tool/">Migrate using the Migration Tool</a>
        </h1>
        
        <div class="content has-text-grey">
          This section refers to migrating end devices to The Things Stack using ttn-lw-migrate migration tool.

        </div>
        <div class="buttons">
          <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/migrate-using-migration-tool/" class="button is-primary is-outlined">Read</a>
        </div>
      </div>
    </div>
  </div>
</div>

        
          <div class="is-clearfix">
<a class="button is-pulled-left" href="/docs/getting-started/migrating/major-changes/">← Major Changes In The Things Stack</a>
<a class="button is-pulled-right" href="/docs/getting-started/migrating/migrating-from-v2/packet-broker-requirements/">Packet Broker Requirements for End Device Migration →</a>
</div>

          <script>window.emojicom_widget = { campaign: "" };</script>
<script src="https://cdn.emojicom.io/embed/widget.js" async></script>

<div class='feedback has-vertical-space'>
  <div id="emojicom-widget-inline"></div>
</div>
        </div>
      </div>
      
      <div class="column is-hidden-touch is-2-desktop sidebar-right">
        <nav class="toc" aria-label="Page navigation">
    <h2 class="title is-size-6">On this page</h2>
    


  <ul class="menu-list">
    
      
      <li><a href='#prerequisites'>Prerequisites</a></li>
    
      
      <li><a href='#add-application-in-the-things-stack'>Add Application in The Things Stack</a></li>
    
      
      <li><a href='#add-payload-formatters-and-integrations-in-the-things-stack'>Add Payload Formatters and Integrations in The Things Stack</a></li>
    
      
      <li><a href='#migrate-end-devices'>Migrate End Devices</a></li>
    
  </ul>


  </nav>

      </div>
      
  </div>
</div>



<footer class="footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-quarter">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
      </nav>
      <nav class="column is-one-quarter">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
        <p><a class="" href="https://www.thethingsnetwork.org/forum/c/network-and-routing/v3">Forum</a></p>
      </nav>
      
      <nav class="column is-one-quarter">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsnetwork.org">The Things Network</a></p>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      <div class="column is-one-quarter">
        <h3 class="title is-6">About this page</h3>
        <div class="content">
<p class="is-size-7">
  Last changed by Nejra Selimović on 30 Jun 2021.
  <br>
  <a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/commit/4bdcb88f2a81c6408669ae47ef0613e3e7ef026c">
      doc: Update migration docs (#386)
    </a>
</p>

<a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/blob/master/doc/content/getting-started/migrating/migrating-from-v2/_index.md" class="button">Edit on Github</a>
</div>

      </div>
    </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.79500656c3860a54b3b38e5f5770a5130bc57306ebb67ca9b057e494f6f4b454.js" integrity="sha256-eVAGVsOGClSzs45fV3ClEwvFcwbrtnypsFfklPb0tFQ=" crossorigin="anonymous"></script><script>
  window.intercomSettings = {
    app_id: "",
  };
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>

</body>

</html>
