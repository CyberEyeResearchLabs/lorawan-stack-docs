<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.70.0" />
  <title>Major Changes In The Things Stack | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/getting-started/migrating/major-changes/" />
  <link rel="alternate icon" href="/docs/favicon.ico">
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.f929bbcfe7661748a056d8d8a4908e1280a5376b425518dbe446a7f00c4d9ce7.css" integrity="sha256-&#43;Sm7z&#43;dmF0igVtjYpJCOEoClN2tCVRjb5Ean8AxNnOc=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
  <meta name="description" content="The Things Stack for LoRaWAN">
  <meta name="keywords" content="">
  <meta itemprop="name" content="Major Changes In The Things Stack">
  <meta itemprop="description" content="The Things Stack for LoRaWAN">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="Major Changes In The Things Stack">
  <meta property="og:description" content="The Things Stack for LoRaWAN">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/getting-started/migrating/major-changes/">
  <meta name="twitter:title" content="Major Changes In The Things Stack" />
  <meta name="twitter:description" content="The Things Stack for LoRaWAN" />
  <meta name="twitter:card" content="summary" />
</head>
<body><nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div id="migration-info">
      <div id="migration-text">thethingsstack.io has moved to thethingsindustries.com/docs</div>
      <div id="migration-button" class="button is-primary">Got it</div>
  </div>
  <div class="container is-fluid">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
        <p class="navbar-item is-size-7">v3.11</p>
      </a>
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a>
      </div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="/docs/download/">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav>
<section class="search-container">
    <div class="container">
      <div class="columns is-vcentered">
        <div class="column">
          <div class="field has-addons has-addons-centered">
            <div class="control">
              <input class="input search-bar" id="search-input" type="text" placeholder="Search" type="text">
            </div>
          </div>
        </div>
      </div>
    </div>
</section>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
apiKey: "",
indexName: "thethingsstack",
inputSelector: '#search-input',
debug: false 
});
</script>
<div class="container" role="document">
  <div class="columns my-0 is-desktop">
      <div class="column is-3-desktop is-2-widescreen sidebar-left">
        

<nav class="side-navigation" aria-label="Main navigation">

<h2 class="title is-size-5">Getting Started</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/getting-started/" class="">Overview</a>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/what-is-tts/" class="">What Is The Things Stack?</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/installation/" class="">Installing The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/" class="">Migrating to The Things Stack</a>
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/major-changes/" class="is-active">Major Changes In The Things Stack</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/gateway-migration/" class="">Migrating Gateways</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/" class="">Migrating from The Things Network Stack V2</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrate-from-chirpstack/" class="">Migrating from ChirpStack</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/device-json/" class="">Importable JSON File Reference</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/import-devices/" class="">Import End Devices in The Things Stack</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/configure-mac-settings/" class="">Fine-tuning MAC Settings for End Devices</a>
    
  </li>

</ul>


    
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/upgrading/" class="">Upgrading The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/cloud-hosted/" class="">The Things Stack Cloud</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/aws/" class="">AWS</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/cli/" class="">Command-line Interface</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/console/" class="">Console</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/troubleshooting/" class="">Troubleshooting Getting Started</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/user-management/" class="">Users and Organizations</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/api/" class="">Using the API</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/events/" class="">Working with Events</a>
  </li>
</ul>



</nav>








      </div>
      <div class="column is-9-desktop is-8-widescreen sidebar-middle">

<div class="docs-content">
<h1 class="title is-size-2">Major Changes In The Things Stack
  
  
  
  
</h1>

<div class="content">
  <p>Before getting started, we will discuss major breaking changes between The Things Network Stack V2
and The Things Stack, along with some guidelines to make the migration process easier to manage.</p>
<h2 id="architecture">Architecture</h2>
<p>The Things Stack is using a new architecture. See <a href="https://www.thethingsindustries.com/docs/reference/components/">Components</a> for a complete overview of the different components of The Things Stack.</p>
<h2 id="lorawan-support">LoRaWAN support</h2>
<p>The Things Stack requires the <strong>LoRaWAN version</strong> and <strong>Regional Parameters</strong> (LoRaWAN PHY version) to be set per end device. These default to LoRaWAN version <strong>1.0.2</strong> and LoRaWAN Regional Parameters version <strong>1.0.2 Rev B</strong> for end devices imported from The Things Network Stack V2
, because this configuration is the most consistent with V2.</p>
<p>This means that all end devices need a frequency plan. You will have to choose the frequency plan corresponding to your region. See <a href="https://www.thethingsindustries.com/docs/reference/frequency-plans/">Frequency Plans</a> for a list of supported Frequency Plans and their respective IDs.</p>
<p>Furthermore, The Things Stack brings full support for all LoRaWAN versions, as well as Class B and Class C modes.</p>
<h2 id="rx1delay">Rx1Delay</h2>
<p>Devices imported from The Things Network Stack V2
are configured with an <code>Rx1Delay</code> of 1 second, by default. In The Things Stack we recommend using an <code>Rx1Delay</code> of 5 seconds to accommodate for high latency backhauls and/or <a href="https://www.thethingsindustries.com/docs/reference/packet-broker/">peering with Packet Broker</a>. See the <a href="https://www.thethingsindustries.com/docs/devices/mac-settings/">MAC settings guide</a> for more information and instructions about configuring <code>Rx1Delay</code>.</p>
<h2 id="gateway-coverage">Gateway Coverage</h2>
<p>The Packet Broker enables peering between networks, so traffic received by one network (e.g. the Public Community Network) but intended for a different network (The Things Stack) can be forwarded to and from that network. See the <a href="https://www.thethingsindustries.com/docs/reference/packet-broker/">Peering Guide</a> for details on Packet Broker and how to enable it for your network.</p>
<p>With Packet Broker enabled on both The Things Stack and The Things Network Stack V2
, you can receive traffic on The Things Stack without having to re-configure any of your gateways.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  Packet Broker is only enabled on The Things Network Public Community Network and The Things Industries Cloud Hosted.
</div>

<p>For private The Things Stack deployments with Packet Broker disabled, you will need to re-configure your gateways to connect to The Things Stack, so that you can start receiving traffic from your end devices.</p>
<p>In order to connect a gateway to The Things Stack, follow instructions for <a href="https://www.thethingsindustries.com/docs/gateways/adding-gateways/">Adding Gateways</a>. Then, reconfigure the gateway to connect to The Things Stack, and regenerate its API key (if required).</p>
<p>Also see <a href="https://www.thethingsindustries.com/docs/gateways/">Gateways</a> for instructions on configuring popular LoRaWAN gateways with The Things Stack.</p>
<h2 id="application-data">Application Data</h2>
<p>The Things Stack uses a different data format for uplink and downlink traffic than The Things Network Stack V2
.</p>
<p>For details on the data format of The Things Network Stack V2
, see the documentation from <a href="https://www.thethingsnetwork.org/docs/applications/mqtt/api.html">The Things Network</a>.</p>
<p>For details on the data format of The Things Stack, see the documentation in <a href="https://www.thethingsindustries.com/docs/reference/data-formats/">Data Formats</a>. It uses a different schema, different names, and has much richer metadata support.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  When migrating to The Things Stack, ensure your application can properly handle the new The Things Stack data format.
</div>

<h3 id="payload-formats">Payload Formats</h3>
<p>The Things Network Stack V2
has support for payload decoders, converters, validators (for uplink) and encoders (for downlink). These can be either CayenneLPP or Javascript functions.</p>
<p>The Things Stack has support for an uplink payload formatter (similar to the payload decoder) and a downlink payload formatter (similar to the payload encoder). These can be set per application, and can even be overridden per end device. Similar to The Things Network Stack V2
, CayenneLPP and Javascript functions are supported.</p>
<p>Migrating the The Things Network Stack V2
payload encoder and decoder to an uplink and downlink payload formatter should be straightforward. See <a href="https://www.thethingsindustries.com/docs/integrations/payload-formatters/">Payload Formatters</a> for more details.</p>
<h3 id="integrations">Integrations</h3>
<p><a href="https://www.thethingsindustries.com/docs/integrations/">Read about the Integrations supported by The Things Stack</a>.</p>
<h4 id="mqtt-traffic">MQTT Traffic</h4>
<p>You will need to change the MQTT server your application connects to. The Things Stack has a new MQTT server address. You will also need to create API keys and update your MQTT credentials accordingly.</p>
<p>Read more on <a href="https://www.thethingsindustries.com/docs/integrations/mqtt/">MQTT Server</a>.</p>
<h4 id="webhooks">Webhooks</h4>
<p>The HTTP Integration is now called HTTP Webhooks. The payload format, downlink endpoints, paths and security settings have changed.</p>
<p>Read more on <a href="https://www.thethingsindustries.com/docs/integrations/webhooks/">HTTP Webhooks</a>.</p>
<h4 id="storage-integration">Storage Integration</h4>
<p>The Things Stack does support a Storage integration similar to The Things Network Stack V2
. Refer to <a href="https://www.thethingsindustries.com/docs/integrations/storage/">Storage Integration</a>.</p>
<h2 id="api-comparison">API Comparison</h2>
<p>The Things Stack provides multiple APIs. Refer to <a href="https://www.thethingsindustries.com/docs/reference/api/">APIs Documentation</a>. For example, MQTT API Comparison is given below.</p>
<h3 id="mqtt-connection-details">MQTT Connection Details</h3>
<table>
<thead>
<tr>
<th><strong>Category/Type</strong></th>
<th><strong>TTI V2</strong></th>
<th><strong>TTS V3</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>MQTT Public Address</td>
<td><code>{tenant_id}.thethings.industries:1883</code></td>
<td><code>https://thethings.example.com:1883</code> (replace with the URL of your deployment)</td>
</tr>
<tr>
<td>MQTT Public TLS Address</td>
<td><code>{tenant_id}.thethings.industries:8883</code> (we have to use the TLS certificate provided in the ttn document)</td>
<td><code>https://thethings.example.com:8883</code></td>
</tr>
<tr>
<td>Username</td>
<td><code>{application_id}</code></td>
<td><code>{application_id}@{tenant_id}</code></td>
</tr>
<tr>
<td>Password</td>
<td>Application Access Key (with default rights)</td>
<td>Application API Key (with &ldquo;Write downlink application traffic&rdquo; and &ldquo;Read application traffic (uplink and downlink)&rdquo; rights)</td>
</tr>
<tr>
<td>Uplink topic (sub)</td>
<td><code>{application_id}/devices/{device_id}/up</code></td>
<td><code>v3/{application id}@{tenant id}/devices/{device id}/up</code></td>
</tr>
<tr>
<td>Downlink scheduling topic (pub)</td>
<td><code>{application_id}/devices/{device_id}/downSchedule</code> the downlink as the first or last item in a downlink queue using &ldquo;schedule&rdquo; key value in the payload.</td>
<td>Push downlink - <code>v3/{application id}@{tenant id}/devices/{device id}/down/push</code>,                                     Replace downlink queue - <code>v3/{application id}@{tenant id}/devices/{device id}/down/replace</code></td>
</tr>
</tbody>
</table>
<h3 id="uplinks">Uplinks</h3>
<table>
<thead>
<tr>
<th><strong>Category/Type</strong></th>
<th><strong>TTI V2</strong></th>
<th><strong>TTS V3</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Overall Uplink Format</td>
<td><details><summary>Show example</summary> {<br>&quot;app_id&rdquo;: &ldquo;my-app-id&rdquo;,  <br>&quot;dev_id&rdquo;: &ldquo;my-dev-id&rdquo;,  <br>&quot;hardware_serial&rdquo;: &ldquo;0102030405060708&rdquo;,<br>&quot;port&rdquo;: 1,  <br>&quot;counter&rdquo;: 2,  <br>&quot;is_retry&rdquo;: false,  <br>&quot;confirmed&rdquo;: false,  <br>&quot;payload_raw&rdquo;: &ldquo;AQIDBA==&rdquo;,  <br>&quot;payload_fields&rdquo;: {<br>&quot;temperature&rdquo;: 1.0,<br>&quot;luminosity&rdquo;: 0.64<br>},,  <br>&quot;metadata&rdquo;: {<br>&quot;airtime&rdquo;: 46336000,  <br>&quot;time&rdquo;: &ldquo;1970-01-01T00:00:00.000000000Z&rdquo;,  <br>&quot;frequency&rdquo;: 868.1,  <br>&quot;modulation&rdquo;: &ldquo;LORA&rdquo;,  <br>&quot;data_rate&rdquo;: &ldquo;SF7BW125&rdquo;,<br>&quot;coding_rate&rdquo;: &ldquo;4/5&rdquo;,  <br>&quot;gateways&rdquo;: [<br>{<br>&quot;gtw_id&rdquo;: &ldquo;ttn-herengracht-ams&rdquo;, <br>&quot;timestamp&rdquo;: 12345,  <br>&quot;time&rdquo;: &ldquo;1970-01-01T00:00:00.000000000Z&rdquo;, <br>&quot;channel&rdquo;: 2,  <br>&quot;rssi&rdquo;: -25,  <br>&quot;snr&rdquo;: 5,  <br>&quot;rf_chain&rdquo;: 0,  <br>&quot;latitude&rdquo;: 52.1234,  <br>&quot;longitude&rdquo;: 6.1234,  <br>&quot;altitude&rdquo;: 6  <br>},<br>//&hellip;more if received by more gateways&hellip;<br>],<br>&quot;latitude&rdquo;: 52.2345,  <br>&quot;longitude&rdquo;: 6.2345,  <br>&quot;altitude&rdquo;: 2  <br>}<br>} </details></td>
<td><details><summary>Show example</summary> {<br>&quot;end_device_ids&rdquo; : {<br>&quot;device_id&rdquo; : &ldquo;my-dev-id&rdquo;,<br>&quot;application_ids&rdquo; : {<br>&quot;application_id&rdquo; : &ldquo;my-app-id&quot;<br>},<br>&quot;dev_eui&rdquo; : &ldquo;0102030405060708&rdquo;,<br>&quot;join_eui&rdquo; : &ldquo;0102030405060708&rdquo;,<br>&quot;dev_addr&rdquo; : &ldquo;01020304&quot;<br>},<br>&quot;correlation_ids&rdquo; : [<br>// …<br>],<br>&quot;received_at&rdquo; : &ldquo;1970-01-01T00:00:00.000000000Z&rdquo;,<br>&quot;uplink_message&rdquo; : {<br>&quot;session_key_id&rdquo; : &ldquo;AXA50tHUGUucuzS/bCGMNw==&rdquo;,<br>&quot;f_cnt&rdquo; : 1,<br>&quot;frm_payload&rdquo; : &ldquo;AQIDBA==&rdquo;,<br>&quot;decoded_payload&rdquo; : {<br>&quot;temperature&rdquo;: 1.0,<br>&quot;luminosity&rdquo;: 0.64<br>},<br>&quot;rx_metadata&rdquo; : [ {<br>&quot;gateway_ids&rdquo; : {<br>&quot;gateway_id&rdquo; : &ldquo;ttn-herengracht-ams&rdquo;,<br>&quot;eui&rdquo; : &ldquo;9C5C8E00001A05C4&quot;<br>},<br>&quot;time&rdquo; : &ldquo;1970-01-01T00:00:00.000000000Z&rdquo;,<br>&quot;timestamp&rdquo; : 12345,<br>&quot;rssi&rdquo; : -25,<br>&quot;channel_rssi&rdquo; : -25,<br>&quot;snr&rdquo; : 5,<br>&quot;uplink_token&rdquo; : &ldquo;ChIKEAoEZ3R3MRIInFyOAAAaBcQQ6L3Vlgk=&rdquo;,<br>&quot;channel_index&rdquo; : 2<br>} ],<br>&quot;settings&rdquo; : {<br>&quot;data_rate&rdquo; : {<br>&quot;lora&rdquo; : {<br>&quot;bandwidth&rdquo; : 125000,<br>&quot;spreading_factor&rdquo; : 7<br>}<br>},<br>&quot;data_rate_index&rdquo; : 5,<br>&quot;coding_rate&rdquo; : &ldquo;4/5&rdquo;,<br>&quot;frequency&rdquo; : &ldquo;868100000&rdquo;,<br>&quot;timestamp&rdquo; : 12345,<br>&quot;time&rdquo; : &ldquo;1970-01-01T00:00:00.000000000Z&quot;<br>},<br>&quot;received_at&rdquo; : &ldquo;1970-01-01T00:00:00.000000000Z&quot;<br>,&ldquo;consumed_airtime&rdquo;: &ldquo;0.051321s&rdquo;,<br>&quot;locations&rdquo;: {<br>&quot;user&rdquo;: {<br>&quot;latitude&rdquo;: 37.97155556731436,<br>&quot;longitude&rdquo;: 23.72678801175413,<br>&quot;altitude&rdquo;: 10,<br>&quot;source&rdquo;: &ldquo;SOURCE_REGISTRY&quot;<br>}<br>},}<br>} </details></td>
</tr>
<tr>
<td>Gateway fields</td>
<td><code>metadata.gateways</code> - This object includes gateway details</td>
<td><code>uplink_message.rx_metadata</code> - This object includes gateway details</td>
</tr>
<tr>
<td></td>
<td><code>metadata.gateways.timestamp</code> - Timestamp when the gateway received the message (microseconds)</td>
<td><code>uplink_message.rx_metadata.timestamp</code> - Gateway concentrator timestamp when the Rx finished (microseconds).</td>
</tr>
<tr>
<td></td>
<td><code>metadata.gateways.time</code> - Time when the gateway received the message</td>
<td><code>uplink_message.rx_metadata.time</code> - Time when the gateway received the message</td>
</tr>
<tr>
<td></td>
<td><code>metadata.gateways.channel</code> - Channel where the gateway received the message</td>
<td>As an alternative channel_index is <code>available.uplink_message.rx_metadata.channel_index</code> - Index of the gateway channel that received the message.</td>
</tr>
<tr>
<td></td>
<td><code>metadata.gateways.rssi</code> - Signal strength of the received message</td>
<td><code>uplink_message.rx_metadata.rssi</code> - Signal strength of the received message</td>
</tr>
<tr>
<td></td>
<td><code>metadata.gateways.snr</code> - Signal to noise ratio of the received message</td>
<td><code>uplink_message.rx_metadata.snr</code> - Signal to noise ratio of the received message</td>
</tr>
<tr>
<td></td>
<td><code>metadata.gateways.rf_chain</code> - RF chain where the gateway received the message</td>
<td>Not available in documentation</td>
</tr>
<tr>
<td></td>
<td><code>metadata.gateways.latitude</code> - Latitude of the gateway reported in its status updates</td>
<td>Not available in documentation</td>
</tr>
<tr>
<td></td>
<td><code>metadata.gateways.longitude</code> - Longitude of the gateway</td>
<td>Not available in documentation</td>
</tr>
<tr>
<td></td>
<td><code>metadata.gateways.altitude</code> - Altitude of the gateway</td>
<td>Not available in documentation</td>
</tr>
<tr>
<td></td>
<td>Not available in documentation</td>
<td><code>uplink_message.rx_metadata.channel_rssi</code> - Received signal strength indicator of the channel (dBm)</td>
</tr>
<tr>
<td></td>
<td>Not available in documentation</td>
<td><code>uplink_message.rx_metadata.uplink_token</code> - Uplink token injected by gateway, Gateway Server or fNS</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Uplink Metadata</td>
<td><code>metadata</code> - This object includes metadata</td>
<td><code>uplink_message</code> - This object includes metadata</td>
</tr>
<tr>
<td></td>
<td><code>metadata.airtime</code></td>
<td><code>uplink_message.consumed_airtime</code> - Formatted as a string, with a suffix for the unit used. For example, <code>&quot;0.051321s&quot;</code> is 0.051321 seconds.</td>
</tr>
<tr>
<td></td>
<td><code>metadata.time</code> - Time when the server received the message</td>
<td><code>uplink_message.received_at</code> - Server time when the Application Server received the message</td>
</tr>
<tr>
<td></td>
<td><code>metadata.frequency</code> - Frequency at which the message was sent</td>
<td><code>uplink_message.settings.frequency</code> - Frequency (Hz)</td>
</tr>
<tr>
<td></td>
<td><code>metadata.modulation</code> - Modulation that was used - LORA or FSK</td>
<td>Not available but as an alternative, modulation can be derived from <code>settings.data_rate</code></td>
</tr>
<tr>
<td></td>
<td><code>metadata.data_rate</code> - Data rate that was used - if LORA modulation</td>
<td><code>uplink_message.settings.data_rate</code> - Data rate of LoRa or FSK</td>
</tr>
<tr>
<td></td>
<td><code>metadata.bit_rate</code> - Bit rate that was used - if FSK modulation</td>
<td><code>uplink_message.settings.data_rate.fsk.bit_rate</code> - Bit rate that was used - if FSK modulation</td>
</tr>
<tr>
<td></td>
<td><code>metadata.coding_rate</code> - Coding rate that was used</td>
<td><code>uplink_message.settings.coding_rate</code> - LoRa coding rate</td>
</tr>
<tr>
<td></td>
<td><code>metadata.latitude</code></td>
<td><code>uplink_message.locations.user.latitude</code> - Latitude of the device</td>
</tr>
<tr>
<td></td>
<td><code>metadata.longitude</code></td>
<td><code>uplink_message.locations.user.longitude</code> - Longitude of the device</td>
</tr>
<tr>
<td></td>
<td><code>metadata.altitude</code></td>
<td><code>uplink_message.locations.user.altitude</code> - Altitude of the device</td>
</tr>
<tr>
<td></td>
<td>Not available</td>
<td><code>uplink_message.locations.user.source</code> - Location source</td>
</tr>
<tr>
<td></td>
<td><code>metadata.data_rate_index</code> - Not available</td>
<td><code>uplink_message.data_rate_index</code> - LoRaWAN data rate index.</td>
</tr>
<tr>
<td></td>
<td><code>metadata.payload_raw</code> - Base64 encoded payload: [0x01, 0x02, 0x03, 0x04]</td>
<td><code>uplink_message.frm_payload</code> - Frame payload (Base64)</td>
</tr>
<tr>
<td></td>
<td><code>port</code> - LoRaWAN FPort</td>
<td><code>uplink_message.f_port</code> - LoRaWAN FPort</td>
</tr>
<tr>
<td></td>
<td><code>counter</code> - LoRaWAN frame counter</td>
<td><code>uplink_message.f_cnt</code> - LoRaWAN frame counter</td>
</tr>
<tr>
<td></td>
<td>Not available in documentation</td>
<td><code>uplink_message.session_key_id</code> - Join Server issued identifier for the session keys used by this uplink</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Common fields</td>
<td><code>app_id</code></td>
<td><code>end_device_ids.application_ids.application_id</code></td>
</tr>
<tr>
<td></td>
<td><code>dev_id</code></td>
<td><code>end_device_ids.device_id</code></td>
</tr>
<tr>
<td></td>
<td><code>hardware_serial</code> - In case of LoRaWAN: the <code>DevEUI</code></td>
<td><code>end_device_ids.dev_eui</code></td>
</tr>
<tr>
<td></td>
<td><code>confirmed</code> - Is set to true if this message was a confirmed message</td>
<td>Not available in documentation</td>
</tr>
<tr>
<td></td>
<td>Not available in documentation</td>
<td><code>end_device_ids.join_eui</code></td>
</tr>
<tr>
<td></td>
<td>Not available in documentation</td>
<td><code>end_device_ids.dev_addr</code></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Uplink Payload fiedls</td>
<td><code>payload_fields</code> - Object containing the results from the payload functions - left out when empty</td>
<td><code>uplink_message.decoded_payload</code></td>
</tr>
<tr>
<td>Correlation IDs</td>
<td>Not available</td>
<td><code>correlation_ids</code></td>
</tr>
</tbody>
</table>
<h3 id="downlinks">Downlinks</h3>
<table>
<thead>
<tr>
<th><strong>Category/Type</strong></th>
<th><strong>TTI V2</strong></th>
<th><strong>TTS V3</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Downlink message overall format</td>
<td><details><summary>Show example</summary>{<br>&quot;port&rdquo;: 1, <br>&quot;confirmed&rdquo;: false,<br>&quot;payload_raw&rdquo;: &ldquo;AQIDBA==&rdquo;, <br>&quot;schedule&rdquo;: &ldquo;replace&rdquo;,<br>}<br><br> or use payload_fields instead <br><br> {<br>&quot;port&rdquo;: 1,<br>&quot;confirmed&rdquo;: false,<br>&quot;payload_fields&rdquo;: {<br>&quot;led&rdquo;: true<br>},<br>&quot;schedule&rdquo;: &ldquo;replace&rdquo;, // allowed values: &ldquo;replace&rdquo; (default), &ldquo;first&rdquo;, &ldquo;last&rdquo;} </details></td>
<td><details><summary>Show example</summary> {<br>&quot;downlinks&rdquo;: [{<br>&quot;f_port&rdquo;: 15,<br>&quot;frm_payload&rdquo;: &ldquo;vu8=&rdquo;,<br>&quot;priority&rdquo;: &ldquo;HIGH&rdquo;,<br>&quot;confirmed&rdquo;: true,<br>&quot;correlation_ids&rdquo;: [&ldquo;my-correlation-id&rdquo;]<br>}]<br>} </details></td>
</tr>
<tr>
<td>Individual fields comparison</td>
<td><code>port</code></td>
<td><code>f_port</code></td>
</tr>
<tr>
<td></td>
<td><code>confirmed</code></td>
<td><code>confirmed</code></td>
</tr>
<tr>
<td></td>
<td><code>payload_raw</code></td>
<td><code>frm_payload</code></td>
</tr>
<tr>
<td></td>
<td><code>schedule</code></td>
<td>Replace and push topics are available as an alternative</td>
</tr>
<tr>
<td></td>
<td>Not available</td>
<td><code>priority</code> - If you do not specify a priority, the default priority LOWEST is used. You can specify LOWEST, LOW, BELOW_NORMAL, NORMAL, ABOVE_NORMAL, HIGH and HIGHEST.</td>
</tr>
<tr>
<td></td>
<td>Not available</td>
<td><code>correlation_ids</code> - You can add multiple custom correlation IDs, for example to reference events or identifiers of your application.</td>
</tr>
<tr>
<td></td>
<td><code>payload_fields</code></td>
<td>Not available in documentation</td>
</tr>
</tbody>
</table>
<h3 id="references">References</h3>
<p><a href="https://www.thethingsnetwork.org/docs/applications/mqtt/api.html">TTI V2 MQTT API Documentation</a></p>
<p><a href="https://www.thethingsindustries.com/docs/integrations/mqtt/">TTS V3 MQTT API Documentation</a></p>

</div>
<div class="is-clearfix">
<a class="button is-pulled-left" href="/docs/getting-started/migrating/">← Migrating to The Things Stack</a>
<a class="button is-pulled-right" href="/docs/getting-started/migrating/gateway-migration/">Migrating Gateways →</a>
</div>

<script>window.emojicom_widget = { campaign: "" };</script>
<script src="https://cdn.emojicom.io/embed/widget.js" async></script>

<div class='feedback has-vertical-space'>
  <div id="emojicom-widget-inline"></div>
</div>
</div>


      </div>
      <div class="column is-hidden-touch is-2-desktop sidebar-right">
        <nav class="toc" aria-label="Page navigation">
    <h2 class="title is-size-6">On this page</h2>
    


  <ul class="menu-list">
    
      <li><a href='#architecture'>Architecture</a></li>
    
      <li><a href='#lorawan-support'>LoRaWAN support</a></li>
    
      <li><a href='#rx1delay'>Rx1Delay</a></li>
    
      <li><a href='#gateway-coverage'>Gateway Coverage</a></li>
    
      <li><a href='#application-data'>Application Data</a></li>
    
      <li><a href='#api-comparison'>API Comparison</a></li>
    
  </ul>


  </nav>

      </div>
  </div>
</div>


<footer class="footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-quarter">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
      </nav>
      <nav class="column is-one-quarter">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
        <p><a class="" href="https://www.thethingsnetwork.org/forum/c/network-and-routing/v3">Forum</a></p>
      </nav>
      
      <nav class="column is-one-quarter">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsnetwork.org">The Things Network</a></p>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      <div class="column is-one-quarter">
        <h3 class="title is-6">About this page</h3>
        <div class="content">
<p class="is-size-7">
  Last changed by Johan Stokking on 18 Feb 2021.
  <br>
  <a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/commit/3ded3bcd44c8738c9970199e96b006b668a44f43">
      doc: Document Packet Broker config with API keys
    </a>
</p>

<a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/blob/master/doc/content/getting-started/migrating/major-changes.md" class="button">Edit on Github</a>
</div>

      </div>
    </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.595b97b16778e75a16096b7412b5ce1e7fff37a56e4e45e7f89921711a3cd177.js" integrity="sha256-WVuXsWd451oWCWt0ErXOHn//N6VuTkXn&#43;JkhcRo80Xc=" crossorigin="anonymous"></script><script>
  window.intercomSettings = {
    app_id: "",
  };
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>

</body>

</html>
