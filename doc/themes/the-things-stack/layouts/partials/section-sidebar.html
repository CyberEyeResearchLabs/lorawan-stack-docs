{{ $currentPage := . }}{{ $currentSection := .FirstSection }}

<h2 class="title is-size-4">{{ $currentSection.Name }}</h2>

<ul class="menu-list">
<a href="{{ $currentSection.Permalink }}" class="{{ if eq $currentPage $currentSection }}is-active{{ end }}">Overview</a>
{{- range $currentSection.Pages.ByWeight }}
  <li>
    <a href="{{ .Permalink }}" class="{{ if eq $currentPage . }}is-active{{ end }}">{{ .Name }}</a>
    {{- if .IsAncestor $currentPage }}
    {{ template "expandifancestor" (dict "section" . "goal" $currentPage ) }}
    {{ end }}
  </li>
{{ end }}
</ul>

{{ define "expandifancestor" }}
{{ $goal := .goal }}
<ul class="menu-list">
{{ range .section.Pages }}
  <li>
    <a href="{{ .Permalink }}" class="{{ if eq $goal . }}is-active{{ end }}">{{ .Name }}</a>
    {{ if .IsAncestor $goal }}
    {{ template "expandifancestor" (dict "section" . "goal" $goal ) }}
    {{ end }}
  </li>
{{ end }}
</ul>
{{ end }}
