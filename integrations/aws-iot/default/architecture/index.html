<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.70.0" />
  <title>Architecture | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/integrations/aws-iot/default/architecture/" />
  <link rel="alternate icon" href="/docs/favicon.ico">
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.f929bbcfe7661748a056d8d8a4908e1280a5376b425518dbe446a7f00c4d9ce7.css" integrity="sha256-&#43;Sm7z&#43;dmF0igVtjYpJCOEoClN2tCVRjb5Ean8AxNnOc=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta itemprop="name" content="Architecture">
  <meta itemprop="description" content="">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="Architecture">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/integrations/aws-iot/default/architecture/">
  <meta name="twitter:title" content="Architecture" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:card" content="summary" />
</head>
<body><nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div id="migration-info">
      <div id="migration-text">thethingsstack.io has moved to thethingsindustries.com/docs</div>
      <div id="migration-button" class="button is-primary">Got it</div>
  </div>
  <div class="container is-fluid">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
        <p class="navbar-item is-size-7">v3.11</p>
      </a>
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a>
      </div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="/docs/download/">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav>
<section class="search-container">
    <div class="container">
      <div class="columns is-vcentered">
        <div class="column">
          <div class="field has-addons has-addons-centered">
            <div class="control">
              <input class="input search-bar" id="search-input" type="text" placeholder="Search" type="text">
            </div>
          </div>
        </div>
      </div>
    </div>
</section>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
apiKey: "",
indexName: "thethingsstack",
inputSelector: '#search-input',
debug: false 
});
</script>
<div class="container" role="document">
  <div class="columns my-0 is-desktop">
      <div class="column is-3-desktop is-2-widescreen sidebar-left">
        

<nav class="side-navigation" aria-label="Main navigation">

<h2 class="title is-size-5">Integrations</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/integrations/" class="">Overview</a>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/adding-applications/" class="">Adding Applications</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/adding-integrations/" class="">Adding Integrations</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/aws-iot/" class="">AWS IoT</a>
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/integrations/aws-iot/default/" class="">Default Integration</a>
    
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/integrations/aws-iot/default/architecture/" class="is-active">Architecture</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/integrations/aws-iot/default/deployment-guide/" class="">Deployment Guide</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/integrations/aws-iot/default/things/" class="">Managing Things</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/integrations/aws-iot/default/messages/" class="">Messages</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/integrations/aws-iot/default/metrics/" class="">Metrics</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/integrations/aws-iot/default/update/" class="">Update</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/integrations/aws-iot/default/uninstall/" class="">Uninstall</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/integrations/aws-iot/default/troubleshooting/" class="">Troubleshooting AWS IoT Integration</a>
    
  </li>

</ul>


    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/integrations/aws-iot/application-server-telemetry/" class="">Application Server Telemetry</a>
    
  </li>

</ul>


    
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/webhooks/" class="">HTTP Webhooks</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/cloud-integrations/" class="">Cloud Integrations</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/mqtt/" class="">MQTT Server</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/mqtt-clients/" class="">Integrations with MQTT Clients</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/pubsub/" class="">Pub/Sub</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/node-red/" class="">Node-RED Integration</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/ifttt/" class="">IFTTT Integration</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/lr1110-geolocation/" class="">Visualize LR1110 Geolocation Data on Ubidots</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/payload-formatters/" class="">Payload Formatters</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/storage/" class="">Storage Integration</a>
  </li>
</ul>



</nav>








      </div>
      <div class="column is-9-desktop is-8-widescreen sidebar-middle">

<div class="docs-content">
<h1 class="title is-size-2">Architecture
  
  
  
  
</h1>

<div class="content">
  <p>The AWS IoT Core integration is a serverless deployment that scales automatically as your deployment grows.</p>
<figure class="plain">
    <img src="../architecture.svg"
         alt="Default integration architecture"/> 
</figure>

<p>The key resources deployed in your AWS account are:</p>
<ul>
<li>Cross-account role for The Things Stack to connect to your AWS IoT Core MQTT endpoint</li>
<li>AWS Lambda functions to create the thing type and configure the integration as pub/sub in The Things Stack</li>
<li>AWS Lambda functions for claiming and creating devices, and for handling uplink and downlink messages</li>
<li>Secret with key encryption key (KEK) to leverage LoRaWAN end-to-end encryption <span class="new-in-version">New in 3.10.0</span>

</li>
<li>IoT Core rules to trigger the Lambda functions based on topics and attributes</li>
</ul>
<p>This is a serverless deployment: there are no compute resources being deployed. AWS only charges for usage, which is driven by traffic. The only continuous charges are by IoT Core connectivity from The Things Stack to your AWS account. All permissions are the minimum permissions for the integration to function.</p>
<h2 id="end-to-end-encryption">End-to-End Encryption <span class="new-in-version">New in 3.10.0</span>

</h2>
<p>This integration supports true LoRaWAN end-to-end encryption: the application payload is encrypted on the end device with the LoRaWAN AppSKey, and decrypted in your AWS Account. The underlying network infrastructure passes your application payload in the encrypted form - it cannot see your data.</p>
<p>When enabled, this integration configures Join Server with your key encryption key (KEK) that is generated in your AWS Account and stored as a secret in <a href="https://aws.amazon.com/secrets-manager/">Secrets Manager</a>. Join Server encrypts the AppSKey with the KEK before passing it to the network layer. The network layer sends the encrypted AppSKey to your AWS Account, where it gets decrypted. This feature only works with devices registered in Join Server.</p>
<p>When using this feature, your AWS application needs to process the LoRaWAN application payload in binary form, as the network layer&rsquo;s payload encoding and decoding functions cannot work with the encrypted data.</p>
</div>
<div class="is-clearfix">
<a class="button is-pulled-left" href="/docs/integrations/aws-iot/default/">← Default Integration</a>
<a class="button is-pulled-right" href="/docs/integrations/aws-iot/default/deployment-guide/">Deployment Guide →</a>
</div>

<script>window.emojicom_widget = { campaign: "" };</script>
<script src="https://cdn.emojicom.io/embed/widget.js" async></script>

<div class='feedback has-vertical-space'>
  <div id="emojicom-widget-inline"></div>
</div>
</div>


      </div>
      <div class="column is-hidden-touch is-2-desktop sidebar-right">
        <nav class="toc" aria-label="Page navigation">
    <h2 class="title is-size-6">On this page</h2>
    



  </nav>

      </div>
  </div>
</div>


<footer class="footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-quarter">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
      </nav>
      <nav class="column is-one-quarter">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
        <p><a class="" href="https://www.thethingsnetwork.org/forum/c/network-and-routing/v3">Forum</a></p>
      </nav>
      
      <nav class="column is-one-quarter">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsnetwork.org">The Things Network</a></p>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      <div class="column is-one-quarter">
        <h3 class="title is-6">About this page</h3>
        <div class="content">
<p class="is-size-7">
  Last changed by i3mSuperMan on 23 Mar 2021.
  <br>
  <a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/commit/998a2d9cfc08ea0fb31fc0ff38774f61e3bc60fe">
      doc: Update aws integration end-to-end-encryption section
    </a>
</p>

<a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/blob/master/doc/content/integrations/aws-iot/default/architecture.md" class="button">Edit on Github</a>
</div>

      </div>
    </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.595b97b16778e75a16096b7412b5ce1e7fff37a56e4e45e7f89921711a3cd177.js" integrity="sha256-WVuXsWd451oWCWt0ErXOHn//N6VuTkXn&#43;JkhcRo80Xc=" crossorigin="anonymous"></script><script>
  window.intercomSettings = {
    app_id: "",
  };
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>

</body>

</html>
